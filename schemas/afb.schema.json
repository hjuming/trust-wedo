{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Answer-First Block",
    "description": "可被 AI 安全使用的答案物件",
    "type": "object",
    "required": [
        "afb_id",
        "entity_id",
        "ai_quick_answer",
        "payload",
        "meta"
    ],
    "properties": {
        "meta": {
            "type": "object",
            "required": [
                "generated_at",
                "tool_version",
                "input_source"
            ],
            "properties": {
                "generated_at": {
                    "type": "string",
                    "format": "date-time",
                    "description": "產生時間（ISO 8601）"
                },
                "tool_version": {
                    "type": "string",
                    "description": "工具版本"
                },
                "input_source": {
                    "type": "string",
                    "description": "輸入來源（檔案路徑或 URL）"
                }
            }
        },
        "afb_id": {
            "type": "string",
            "pattern": "^afb:",
            "description": "AFB ID，格式：afb:page:type"
        },
        "entity_id": {
            "type": "string",
            "pattern": "^ent:",
            "description": "關聯的實體 ID"
        },
        "ai_quick_answer": {
            "type": "string",
            "minLength": 1,
            "description": "AI 快速答案"
        },
        "context_fit": {
            "type": "object",
            "description": "使用情境限制",
            "properties": {
                "use_when": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "description": "適用情境"
                },
                "do_not_use_when": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "description": "不適用情境"
                }
            }
        },
        "confidence_signals": {
            "type": "object",
            "description": "信任信號",
            "properties": {
                "entity_confidence": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 1
                },
                "citation_count": {
                    "type": "integer",
                    "minimum": 0
                }
            }
        },
        "eligibility": {
            "type": "string",
            "enum": [
                "pass",
                "fail"
            ],
            "description": "資格判定（pass: EC >= 0.60, fail: EC < 0.60）"
        },
        "reasons": {
            "type": "array",
            "items": {
                "type": "string"
            },
            "description": "失敗或警告原因（eligibility=fail 時必填）"
        },
        "payload": {
            "type": "object",
            "description": "結構化答案 payload",
            "required": [
                "@type",
                "answer",
                "entity_id"
            ],
            "properties": {
                "@type": {
                    "type": "string",
                    "description": "答案類型"
                },
                "answer": {
                    "type": "string",
                    "description": "答案內容"
                },
                "entity_id": {
                    "type": "string",
                    "pattern": "^ent:",
                    "description": "實體 ID"
                }
            }
        }
    }
}